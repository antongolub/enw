define(["framework","underscore","backbone","modules/mainPack"],function(e,t,n){return function(o){var r,i,a,u=this,s=0,l="enw"+(1e5*Math.random()|0),d={},c=function(e){return s=d.status=e,e},f=function(e){return e&&e.$el?(e.undelegateEvents(),e.$el.unbind(),e.$el.remove(),e.remove(),n.View.prototype.remove.call(e),e={},!0):!1},p=function(t,n){var r=function(){return t?(r=function(t){return t&&(f(d),c(0),d=new(t.extend({el:o.$container.get(0),id:l,status:s,host:o.host,title:o.title||t.prototype.title,setStatus:c,delayedSetModeArgs:[].concat(o.mode||d.delayedSetModeArgs)})),(a=e.proxy(d.render,d.self))()),a},require([t],r),r):void 0};return n?require([n],r):r(),r},g=function(){return function(){return p(r,i)}},w=function(n){n=t.extend({},o,n);var a=null,u=["gia","ege","sou","population"];switch(n.type&&!t.contains(u,n.type)&&(a=1),n.host||(a=3),n.interval&&n.interval>0&&n.interval<5&&(n.interval=5,console.warn("Too short interval. It should be at least 5m or 0 if you don't need autoupdate")),n.$container=e(n.container).eq(0),n.$container.length||(a=2),n.type){case"gia":r="views/exams/giaExamsView",i="modules/examsModule";break;case"ege":r="views/exams/examsView",i="modules/examsModule";break;case"sou":r="views/sou/souView",i="modules/souModule";break;case"population":r="views/population/populationView",i="modules/populationModule"}return a?(c(-1),console.warn("Invalid config. See elasticnode.ru/widgets/#error"+a+" for details"),{error:a}):n},h=function(e,n){return e=w(e),e.hasOwnProperty("error")||t.isEqual(e,o)||(o.type!==e.type?(o=e,a=new g):(n.$el&&(e.title&&n.title!==e.title&&(n.title=e.title,n.renderTitle()),o.$container.get(0)!==e.$container.get(0)&&e.$container.after(n.$el.detach()),n.interval=e.interval),e.host&&o.host!==e.host&&(n.host=e.host,n.modelInit()),o=e),n.delayedSetModeArgs=[].concat(e.mode),a()),e};a=new g,u.getStatus=function(){return s},u.getNode=function(){return d.$el||null},u.setConfig=function(e){return h(e,d)},u.setMode=function(){return d.delayedSetModeArgs=arguments,d.switchModeDelayed?(d.switchModeDelayed(),!0):!1},u.destroy=function(){f();var e;for(e in this)this.hasOwnProperty(e)&&delete this[e];return u.ptototype={},c(-1),"Completely destroyed view and object methods (id: "+l+")"},h(void 0,d),u.__testonly__={applyConfig:h,validateConfig:w,setView:function(e){return d=e},getView:function(){return d},getRenderer:function(){return a},getConfig:function(){return o},Loader:g,loadRenderer:p,flushView:f,setStatus:c}}});