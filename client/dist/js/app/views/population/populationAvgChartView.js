define(["views/chartView","underscore","utils"],function(e,t,i){return e.extend({type:"spline",options:{yAxis:{title:{text:"population".toLocaleString()},min:0},plotOptions:{series:{point:{events:{click:function(){return this.series.chart.options.getWidget().switchMode({year:this.category}),this.category}}}}},series:[{name:"male".toLocaleString()},{name:"female".toLocaleString()},{name:"total".toLocaleString()}],tooltip:{formatter:function(){return"<b>"+this.series.name+"</b><br/>"+this.x+": "+this.y.toPrecision(3)}}},update:function(e){if(this.chart&&e){var a,n,o=1/0,r=-1/0,s={male:[],female:[],total:[]};return t.each(e,function(e){e.year>r&&(r=e.year),e.year<o&&(o=e.year)}),t.each(e,function(e){n=e.year-o,e=e.population,s.male[n]=i.sum(e.male),s.female[n]=i.sum(e.female),s.total[n]=e.overall}),a=t.range(o,r+1),t.each(s,function(e){e=i.replace(void 0,null)}),this.updateSpline(s.male,s.female,s.total),this.chart.xAxis[0].setCategories(a,!1),this.redraw(),s}}})});