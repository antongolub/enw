define(["framework","views/defaultView","text!templates/populationTpl.hbs","models/populationModel","underscore","utils","views/population/populationAvgChartView","views/population/populationYearChartView"],function(e,t,i,n,a,r,o,s){var l=".enw__menu";return t.extend({template:i,name:"populationTpl",title:"populationTitle",ModelConstructor:n,mode:{year:"avg"},renderData:function(){var e=this.model.get("collection"),t=this.getRelatedView();return this.renderMenu&&(this.renderMenu(["avg"].concat(a.uniq(a.pluck(e,"year"))),l),this.renderMenu=void 0),this.showMsg(),t&&(t.render(e||this.model.get("population")),this.switchRelatedView(t.$el)),this.model.attributes},afterRender:function(){var t=".enw__menu__link";this.$el.on("click",t,e.proxy(this.onMenuClick,this))},getRelatedView:function(){var e,t,i,n=this.mode;return"avg"===n.year?(t="avgChart",e=".avgChart",i=o):(t="yearChart",e=".yearChart",i=s),this.initRelatedView(t,i,e)},onMenuClick:function(t){var i=e(t.target),n=i.data("href");return 2===this.status&&this.switchMode(n),n},switchMode:function(e){var t=this.setMode(e),i=this.model,n=i.host+"/"+i.path;return t&&(this.selectMenuItem(t.year,this.$el.find(l)),"avg"!==t.year&&(n+="/"+t.year),this.fetch(n)),t}})});