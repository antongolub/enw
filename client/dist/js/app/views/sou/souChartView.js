define(["views/chartView","underscore","utils"],function(e,t,a){return e.extend({update:function(e,r){if(this.chart&&e){var i,n,s,o,l=1/0,c=[],d=[],h=this.chart.series,g=h[0],u=h[1];return t.each(e,function(e){n=e.indicator.quality,e.year<l&&(l=e.year),n.raw&&(d[e.year]=n.raw[0].average),c[e.year]=n.average}),c=a.replace(c.slice(l,c.length),void 0,null),i=t.range(l,l+c.length),this.chart.xAxis[0].setCategories(i),s={data:c,name:"sou".toLocaleString()},g?g.update(s,!1):this.chart.addSeries(s,!1),d.length?(d=a.replace(d.slice(l,d.length),void 0,null),o={data:d,name:"sou".toLocaleString()+"-"+String(r).toLocaleString().toLocaleLowerCase()},u?u.update(o,!1):this.chart.addSeries(o,!1)):u&&(u.options.showInLegend=!1,u.legendItem=null,this.chart.legend.destroyItem(u),u.remove(!1)),this.chart.legend.render(),this.redraw(),h}}})});